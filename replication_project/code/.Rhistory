intcont02 = ~ if_else(year == 2002, lag(., 2), 0)),
.names = "{.fn}_{.col}")) %>%
mutate(restsamp = ifelse(uf %in% c("AL", "AP", "RJ", "RR"), 0, 1))
var_list0 = c("util_rate", "ag_ssaude", "ag_vis7_ined2", "ag_lb_ined")
# Calculate means and standard deviations for each variable
coef_list = list()
se_list = list()
p_value_list = list()
covars = c("ag_vis_ined_cover", "ag_lb_ined_cover", colnames(df_state %>%
select(starts_with("reg") | starts_with("delec") | starts_with("duf") | starts_with("dtrend_elec"))))
control_vars98 = colnames(df_state %>%
select(starts_with("intcont98")))[c(1, 3, 5, 4, 2, 6, 7)]
control_vars02 = colnames(df_state %>%
select(starts_with("intcont02")))[c(1, 3, 5, 4, 2, 6, 7)]
# Colunm 1
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "1")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "1")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "1")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
# Columns 2-8
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = clustered["z", "Estimate"]
se_list[[paste0(var, i+1)]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
}
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = clustered["z", "Estimate"]
se_list[[paste0(var, i+1)]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, i+1)]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
# Column 9
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "9")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "9")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "9")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
# Column 10
df = subset(df_state, restsamp == 1)
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[3:52], collapse = " + "))), data = df)
df$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(covars[3:52], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "10")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[c(1, 3:52)], collapse = " + "))), data = df)
df$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(covars[c(1, 3:52)], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "10")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[2:52], collapse = " + "))), data = df)
df$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(covars[2:52], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "10")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
# Column 11
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[3:79], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(covars[3:79], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "11")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[c(1, 3:79)], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(covars[c(1, 3:79)], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "11")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[2:79], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(covars[2:79], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "11")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
# Correlation matrix
cor_matrix = cor(df_state %>% filter(year == 1998) %>% select(inst, all_of(control_list[1:7])), use = "complete.obs")
# Constructing table
output_table = matrix("", nrow = 18, ncol = 12)
# Fill the first column with variable names, "bandwidth", and "obs"
output_table[seq(1, length(var_list0)*3, 3), 1] = var_list0
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, 2] = sprintf("%.3f", coef_list[[paste0(var, 1)]])
output_table[3*j - 1, 2] = sprintf("(%.3f)", se_list[[paste0(var, 1)]])
output_table[3*j, 2] = sprintf("(%.3f)", p_value_list[[paste0(var, 1)]])
}
for (i in 2:8) {
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, i+1] = sprintf("%.3f", coef_list[[paste0(var, i)]])
output_table[3*j - 1, i+1] = sprintf("(%.3f)", se_list[[paste0(var, i)]])
output_table[3*j, i+1] = sprintf("(%.3f)", p_value_list[[paste0(var, i)]])
}
}
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, 10] = sprintf("%.3f", coef_list[[paste0(var, 10)]])
output_table[3*j - 1, 10] = sprintf("(%.3f)", se_list[[paste0(var, 10)]])
output_table[3*j, 10] = sprintf("(%.3f)", p_value_list[[paste0(var, 10)]])
}
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, 10] = sprintf("%.3f", coef_list[[paste0(var, 9)]])
output_table[3*j - 1, 10] = sprintf("(%.3f)", se_list[[paste0(var, 9)]])
output_table[3*j, 10] = sprintf("(%.3f)", p_value_list[[paste0(var, 9)]])
}
for (i in 2:11) {
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, i+1] = sprintf("%.3f", coef_list[[paste0(var, i)]])
output_table[3*j - 1, i+1] = sprintf("(%.3f)", se_list[[paste0(var, i)]])
output_table[3*j, i+1] = sprintf("(%.3f)", p_value_list[[paste0(var, i)]])
}
}
for (i in 1:11) {
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, i+1] = sprintf("%.3f", coef_list[[paste0(var, i)]])
output_table[3*j - 1, i+1] = sprintf("(%.3f)", se_list[[paste0(var, i)]])
output_table[3*j, i+1] = sprintf("(%.3f)", p_value_list[[paste0(var, i)]])
}
}
output_table[13, 1:12] = c("GDP, Gini, Poverty, Pop.", "Yes", "—", "—", "—", "—", "—", "—", "—", "—", "—", "—")
output_table[14, 1:12] = c("Time-Dummies Interac. w/", "—", "GDP", "Gini", " Illit.", "Poverty", "Pop.", "Area", "#Munic.", "Pop. & Area", "—", "—")
View(cor_matrix)
cor_matrix[1]
cor_matrix[2]
corr = cor_matrix[2:7]
corr
corr = cor_matrix[2:8]
corr
output_table[15, 1:12] = c("[Correlation of Var. w/ Si]", "—", corr, "Pop. & Area", "—", "—")
round(corr, 3)
output_table[15, 1:12] = c("[Correlation of Var. w/ Si]", "—", round(corr, 3), "Pop. & Area", "—", "—")
output_table[16, 1:12] = c("Restricted Sample", "—", "—", "—", "—", "—", "—", "—", "—", "—", "Yes", "—")
output_table[17, 1:12] = c("State-Specific Trends", "—", "—", "—", "—", "—", "—", "—", "—", "—", "—", "Yes")
output_table[18, 1:12] = c("N", 81, 81, 81, 81, 81, 81, 81, 81, 81, 69, 81)
# Convert to data frame for stargazer output
output_df = as.data.frame(output_table)
colnames(output_df) = c("", "(1)", "(2)", "(3)", "(4)", "(5)", "(6)", "(7)", "(8)", "(9)", "(10)", "(11)")
# Display the table with stargazer
stargazer(
output_df,
type = "text",
summary = FALSE,
title = "Table VI",
rownames = FALSE
)
control_list = c("ag_lgdp", "ag_gini", "illiter", "ag_poverty", "ag_lpop", "area", "ag_munic_percapita", "none")
df_state = df_state %>%
mutate(across(all_of(control_list),
list(intcont98 = ~ if_else(year == 1998, lag(.), 0),
intcont02 = ~ if_else(year == 2002, lag(., 2), 0)),
.names = "{.fn}_{.col}")) %>%
mutate(restsamp = ifelse(uf %in% c("AL", "AP", "RJ", "RR"), 0, 1))
var_list0 = c("util_rate", "ag_ssaude", "ag_vis7_ined2", "ag_lb_ined")
# Calculate means and standard deviations for each variable
coef_list = list()
se_list = list()
p_value_list = list()
covars = c("ag_vis_ined_cover", "ag_lb_ined_cover", colnames(df_state %>%
select(starts_with("reg") | starts_with("delec") | starts_with("duf") | starts_with("dtrend_elec"))))
control_vars98 = colnames(df_state %>%
select(starts_with("intcont98")))[c(1, 3, 5, 4, 2, 6, 7)]
control_vars02 = colnames(df_state %>%
select(starts_with("intcont02")))[c(1, 3, 5, 4, 2, 6, 7)]
# Colunm 1
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "1")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "1")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_list[c(1, 5, 2, 4)], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_list[c(1, 5, 2, 4)], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "1")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "1")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "1")]] = clustered["z", "Pr(>|t|)"]
# Columns 2-8
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = clustered["z", "Estimate"]
se_list[[paste0(var, i+1)]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
}
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = clustered["z", "Estimate"]
se_list[[paste0(var, i+1)]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
for (i in 1:length(control_vars02)) {
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[i], control_vars02[i], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[i], control_vars02[i], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, i+1)]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, i+1)]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, i+1)]] = clustered["z", "Pr(>|t|)"]
}
# Column 9
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[3:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[3:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "9")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[c(1, 3:52)]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[c(1, 3:52)]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "9")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(c(control_vars98[5:6], control_vars02[5:6], covars[2:52]), collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(c(control_vars98[5:6], control_vars02[5:6], covars[2:52]), collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "9")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "9")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "9")]] = clustered["z", "Pr(>|t|)"]
# Column 10
df = subset(df_state, restsamp == 1)
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[3:52], collapse = " + "))), data = df)
df$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(covars[3:52], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "10")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[c(1, 3:52)], collapse = " + "))), data = df)
df$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(covars[c(1, 3:52)], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "10")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste(covars[2:52], collapse = " + "))), data = df)
df$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(covars[2:52], collapse = " + "))),
data = df)
df$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "10")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "10")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "10")]] = clustered["z", "Pr(>|t|)"]
# Column 11
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[3:79], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
for (j in 1:length(var_list0[1:2])) {
var = var_list0[j]
model2 = lm(as.formula(paste(var, "~", paste(covars[3:79], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "11")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
}
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[c(1, 3:79)], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[3]
model2 = lm(as.formula(paste(var, "~", paste(covars[c(1, 3:79)], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = clustered["z", "Estimate"]
se_list[[paste0(var, "11")]] = clustered["z", "Std. Error"]
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
model1 = lm(as.formula(paste0(var_list2[3], "~", paste0(covars[2:79], collapse = " + "))), data = df_state)
df_state$z = residuals(model1)
var = var_list0[4]
model2 = lm(as.formula(paste(var, "~", paste(covars[2:79], collapse = " + "))),
data = df_state)
df_state$y_z = residuals(model2)
model3 = lm(y_z ~ z, data = df_state)
clustered = coeftest(model3, vcov = vcovCL, cluster = ~ uf)
coef_list[[paste0(var, "11")]] = (clustered["z", "Estimate"])*100
se_list[[paste0(var, "11")]] = (clustered["z", "Std. Error"])*100
p_value_list[[paste0(var, "11")]] = clustered["z", "Pr(>|t|)"]
# Correlation matrix
cor_matrix = cor(df_state %>% filter(year == 1998) %>% select(inst, all_of(control_list[1:7])), use = "complete.obs")
corr = cor_matrix[2:8]
# Constructing table
output_table = matrix("", nrow = 18, ncol = 12)
# Fill the first column with variable names, "bandwidth", and "obs"
output_table[seq(1, length(var_list0)*3, 3), 1] = var_list0
for (i in 1:11) {
for (j in 1:length(var_list0)) {
var = var_list0[j]
output_table[3*j - 2, i+1] = sprintf("%.3f", coef_list[[paste0(var, i)]])
output_table[3*j - 1, i+1] = sprintf("(%.3f)", se_list[[paste0(var, i)]])
output_table[3*j, i+1] = sprintf("(%.3f)", p_value_list[[paste0(var, i)]])
}
}
output_table[13, 1:12] = c("GDP, Gini, Poverty, Pop.", "Yes", "—", "—", "—", "—", "—", "—", "—", "—", "—", "—")
output_table[14, 1:12] = c("Time-Dummies Interac. w/", "—", "GDP", "Gini", " Illit.", "Poverty", "Pop.", "Area", "#Munic.", "Pop. & Area", "—", "—")
output_table[15, 1:12] = c("[Correlation of Var. w/ Si]", "—", round(corr, 3), "Pop. & Area", "—", "—")
output_table[16, 1:12] = c("Restricted Sample", "—", "—", "—", "—", "—", "—", "—", "—", "—", "Yes", "—")
output_table[17, 1:12] = c("State-Specific Trends", "—", "—", "—", "—", "—", "—", "—", "—", "—", "—", "Yes")
output_table[18, 1:12] = c("N", 81, 81, 81, 81, 81, 81, 81, 81, 81, 69, 81)
# Convert to data frame for stargazer output
output_df = as.data.frame(output_table)
colnames(output_df) = c("", "(1)", "(2)", "(3)", "(4)", "(5)", "(6)", "(7)", "(8)", "(9)", "(10)", "(11)")
# Display the table with stargazer
stargazer(
output_df,
type = "text",
summary = FALSE,
title = "Table VI",
rownames = FALSE
)
